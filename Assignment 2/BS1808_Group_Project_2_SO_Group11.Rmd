---
title: "BS1808 Logistics and Supply Chain Analytics Group Assignment Two"
author: "Jone Leung, Somto Okoye, Valentin Poirelle, Jin Anne Lee, Jim Leach, Niccolo Valerio"
date: "18 June 2016"
output:
  html_document:
    code_folding: hide
    keep_md: yes
    number_sections: yes
    theme: readable
    toc: yes
    toc_float: yes
---

<br>
<br>
<p style="border:1.5px; border-style:solid; border-color:#000000; padding: 1em;"> This `HTML` report is best viewed using a modern web browser such as Mozilla Firefox or Google Chrome. It is also available on the [online repository](https://github.com/Jim89/lsca_group). Printing is possible but will not produce an optimal reading experience.</p>

```{r prep, echo = TRUE, message=FALSE}
# Set default knitr options
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.align = "center")

# Load packages
library(dplyr)
library(tidyr)
library(ggplot2)
library(knitr)
library(purrr)
library(readxl)
```

# Introduction

## Project overview

The overarching goal of this project is to optimise inventory and redesign the supply chain network of BioPharma, a chemical company. We use a combination of optimisation, heuristics and decision trees to evaluate improvements in order to make recommendations for courses of actions so that the company can cut costs and stay competitive in the global market.

# Wiser on Hindsight: What could have been done in 2009

In 2009, all six of BioPharma's plants maintained its capabilities for producing both Highcal and Relax; these chemicals can be shipped to any other parts of the world with additional costs attached. Furthermore, BioPharma faces import duties for all foreign goods entering a country, independent from plant origin. Under these conditions, the following optimisation problem is constructed to identify a more efficient use of resources.

## The Optimisation Problem

__Decision Variables__

* $Q_{i,j,k}$ is the quantity of chemical $i$ to produce from plant $j$ for region $k$,
* $F_{all,j}$ is the fixed cost independent of chemical produced for plant $j$,
* $F_{i,j}$ is the fixed cost associated to producing chemical $i$ in plant $j$,
* $V_{i,j}$ is the total variable costs of raw materials and production costs,
* $T_{j,k}$ is the transportation costs for shipping from plant $j$ to region $k$, and
* $I_{j,k}$ is the import costs for importing from plant $j$ to region $k$

__Objective Function__

The objective functino above is adjusted as follows: using the Brazil plant as follows, the costs function associated to Brazil is

minimise 

$\sum_{k=1}^6\sum_{j=1}^6 \sum_{i=1}^2 F_{all,j} + F_{i,j} + Q_{i,j,k}.(V_{i,j}+T_{j,k})( \textbf{1} +I_{j,k})$

where $\textbf{1}$ is the unit vector.

__Constraints__

* Non-negative quantities $Q_{i,j,k}$
* Maximum plant capacity for producing both chemicals
* Meeting sales and demand levels 

## Results

Biopharma should have utilised its resources in the following way:

```{r show_output}
# Get raw demand data
output <- read_excel("optim1.xlsx", sheet = "Sheet1")
output

```

The total cost for this new plan is USD1,372,432,000.00. 

Under this plan, the


The Japanese factory should have been idled because it was only producing 1mil units of Highcal for the local supply. The production of 1million units can be shifted to the plant in India, who is already producing units of Highcal for the Japanese market. This allows BioPharma to save on fixed costs, even though it is not the optimal plan. If the Japanese fatory were to be idled, only the fixed costs will be incurred and the cost of this new plan will be USD1,360,932,000.00. 



Under this plan, the Latin America market is served by 

# Global Supply Network Structure

## Optimisation under options
In restructuring its global supply network structure, BioPharma has to consider exchange rate fluctuations and the option of shutting down factories simultaneously. 

The options available to the network design team are:

1. Keep global network with its current structure and capabilities.
2. Limiting the capability of some plants to producing only one chemical, where a plant is limited to producing only one chemical and it saves 80% of the fixed costs associated with the chemical that is no longer produced.
3. Closing down some plants, where closing down a plant eliminates all variable costs and saves 80% of annual fixed costs.

Assuming that demand in 2010 is stable and is the same as in 2009: the new objective function is as follows:

minimise $(0.8B_0+0.2).F_{all,Brazil}+(0.8B_1+0.2).F_{Brazil,Highcal}+B_1*\sum_{k=1}^6 Q_{Highcal,Brazil,k}.(V_{Highcal,Brazil}+T_{Brazil,k}).( \textbf{1} +I_{Brazil,k})$

where 

* $B_0$ is the switch for closing or opening the entire Brazil factory
* $B_1$ is the switch for controlling the fixed costs for Highcal 
* $B_2$ is the switch for controlling the fixed costs for Relax 

under the additional conditions of

* $B_0 \geq B_1$, so that no Highcal is produced when the factory is shut
* $B_0 \geq B_2$, so that no Relax is produced when the factory is shut

## Results

```{r show_output2}
# Get raw demand data
output2 <- read_excel("optim1.xlsx", sheet = "Sheet2")
output2

```

## Exchange Rates

The exchange rates can affect the profit of the business. For example, the costs of doing business from a plant can be significantly lower due to weakened exchange rates. BioPharma can opt to redistribute production to different plants based on exchange rates. 

A decision tree is used to calculate the expected return of each plant to see the effects of exchange rate on expected profits and if any of the plants should be closed. Assuming that the exchange rates in 2010 can fall or rise to any of the rates from 2004 to 2009 with equal probability, the following decision tree with expected costs is constructed: 

From the decision tree


# Are there any plant for which it may be worth adding a million kilogams of additional capacity at a fixed cost of Â£3million a year?


# Any recommendations made by the reduction of duties


# Not 100% yield


# What other factors to be considered when making your recommendations?
